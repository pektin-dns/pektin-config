{"$schema":"http://json-schema.org/draft-07/schema#","title":"Pektin Config","description":"The configuration for the Pektin DNS server","type":"object","additionalProperties":false,"properties":{"services":{"type":"object","additionalProperties":false,"required":["ui","api","vault","recursor","ribston","opa"],"properties":{"ui":{"type":"object","additionalProperties":false,"required":["enabled","subDomain","domain"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]}}},"api":{"type":"object","additionalProperties":false,"required":["subDomain","domain"],"properties":{"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]}}},"vault":{"type":"object","additionalProperties":false,"required":["subDomain","domain"],"properties":{"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]}}},"recursor":{"type":"object","additionalProperties":false,"required":["enabled","subDomain","domain"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]}}},"ribston":{"type":"object","additionalProperties":false,"required":["enabled"],"properties":{"enabled":{"type":"boolean","examples":[{}]}}},"opa":{"type":"object","additionalProperties":false,"required":["enabled"],"properties":{"enabled":{"type":"boolean","examples":[{}]}}}}},"usePolicies":{"type":"string","enum":["ribston","opa","both",false],"examples":[{}]},"nodes":{"type":"array","minItems":1,"items":{"type":"object","additionalProperties":false,"required":["name"],"properties":{"main":{"type":"boolean","examples":[{}]},"ips":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/Ip","examples":[{}]}},"legacyIps":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/LegacyIp","examples":[{}]}},"name":{"type":"string","examples":[{}]},"ansible":{"$ref":"#/$defs/AnsibleConfig","examples":[{}]},"setup":{"type":"object","additionalProperties":false,"required":["system","root","cloneRepo","setup","start"],"properties":{"system":{"type":"string","examples":[{}]},"root":{"type":"object","additionalProperties":false,"properties":{"disableSystemdResolved":{"type":"boolean","examples":[{}]},"installDocker":{"type":"boolean","examples":[{}]}},"required":["disableSystemdResolved","installDocker"]},"cloneRepo":{"type":"boolean","examples":[{}]},"setup":{"type":"boolean","examples":[{}]},"start":{"type":"boolean","examples":[{}]}}}}}},"nameservers":{"type":"array","minItems":1,"items":{"type":"object","additionalProperties":false,"required":["domain","node"],"properties":{"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]},"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"node":{"type":"string","examples":[{}]},"main":{"type":"boolean","examples":[{}]}}}},"letsencrypt":{"type":"object","additionalProperties":false,"required":["enabled","letsencryptEmail"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"letsencryptEmail":{"$ref":"#/$defs/Email","examples":[{}]}}},"build":{"type":"object","additionalProperties":false,"required":["server","api","ui","ribston","recursor","vault"],"properties":{"server":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}},"api":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}},"ui":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}},"ribston":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}},"recursor":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}},"vault":{"type":"object","additionalProperties":false,"required":["enabled","path"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"path":{"type":"string","examples":[{}]}}}}},"reverseProxy":{"type":"object","additionalProperties":false,"required":["routing","tls","createTraefik","external","tempZone","traefikUi"],"properties":{"routing":{"enum":["local","domain","minikube"],"examples":[{}]},"tempZone":{"type":"object","additionalProperties":false,"required":["enabled","provider","routing"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"provider":{"type":"string","description":"Get a temporary subdomain for an easy and secure access while your domain changes still propagate. This subdomain will exist for 7 days, will then be deleted and not be recoverable afterwards. For pektin.zone. this implies your acceptance of our privacy policy.","examples":[{}]},"routing":{"enum":["local","public"],"examples":[{}]}}},"tls":{"type":"boolean","examples":[{}]},"createTraefik":{"type":"boolean","examples":[{}]},"traefikUi":{"type":"object","additionalProperties":false,"required":["enabled","domain","subDomain"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"domain":{"type":"string","examples":[{}]},"subDomain":{"type":"string","examples":[{}]}}},"external":{"description":"Proxy to external APIs that aren't configured to use CORS.","type":"object","additionalProperties":false,"required":["enabled","subDomain","domain","services"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"domain":{"$ref":"#/$defs/DomainName","examples":[{}]},"subDomain":{"$ref":"#/$defs/SubDomain","examples":[{}]},"services":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["name","enabled","domain","accessControlAllowMethods"],"properties":{"enabled":{"type":"boolean","examples":[{}]},"name":{"type":"string","examples":[{}]},"domain":{"type":"string","examples":[{}]},"accessControlAllowMethods":{"type":"array","items":{"type":"string","examples":[{}]}}}}}}}}},"ansible":{"type":"object","additionalProperties":false,"required":["sshPubKeyName"],"properties":{"sshPubKeyName":{"type":"string","examples":[{}]}}}},"required":["services","nodes","nameservers","letsencrypt","reverseProxy","build","usePolicies"],"$defs":{"DomainName":{"type":"string","description":"A valid UTF8 domain name"},"SubDomain":{"type":"string","description":"A valid UTF8 domain name not ending with a dot"},"Ip":{"type":"string","description":"A valid ip(ipv6) address","pattern":"^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$"},"LegacyIp":{"type":"string","description":"A valid legacyIp(ipv4) address","pattern":"^(\\b25[0-5]|\\b2[0-4][0-9]|\\b[01]?[0-9][0-9]?)(\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$"},"Email":{"type":"string","description":"A valid email address"},"NodeName":{"type":"string","description":"A alphanumeric hostname for the node not containing double minuses \"--\"","pattern":"^((?!--)[a-z0-9-_])*$"},"SupportedRegistrars":{"enum":["gandi"]},"AnsibleConfigType":{"type":"string","enum":["hetzner"]},"AnsibleConfig":{"oneOf":[{"$ref":"#/$defs/Hetzner"}]},"Hetzner":{"type":"object","additionalProperties":false,"required":["configType"],"properties":{"configType":{"$ref":"#/$defs/AnsibleConfigType"},"floatingIp":{"type":"boolean"},"floatingLegacyIp":{"type":"boolean"},"location":{"type":"string","enum":["nbg1","fsn1"]},"serverType":{"$ref":"#/$defs/HetznerServerType"}}},"HetznerServerType":{"type":"string","enum":["cx11","cpx11","cx21","cpx21","cx31","cpx31","cx41","cpx41","cx51","cpx51"]}}}